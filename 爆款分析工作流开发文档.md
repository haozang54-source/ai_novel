# çˆ†æ¬¾åˆ†æå·¥ä½œæµå¼€å‘æ–‡æ¡£

## 1. é¡¹ç›®æ¦‚è¿°

### 1.1 ç›®æ ‡
å¼€å‘ä¸€ä¸ªç‹¬ç«‹çš„çˆ†æ¬¾å°è¯´åˆ†æç³»ç»Ÿï¼Œé‡‡ç”¨åˆ†å±‚æ¦‚æ‹¬çš„æ–¹å¼å¤„ç†é•¿ç¯‡å°è¯´ï¼Œä»å¤šä¸ªtxtæ–‡ä»¶ä¸­æå–æ ¸å¿ƒè¦ç´ ï¼Œç”Ÿæˆæ ‡å‡†åŒ–çš„åˆ›ä½œæ¨¡æ¿ã€‚

### 1.2 æ ¸å¿ƒåŠŸèƒ½
- æ‰¹é‡åŠ è½½å¹¶é¢„å¤„ç†txtå°è¯´æ–‡ä»¶
- **åˆ†å±‚æ¦‚æ‹¬ï¼š** é€ç« æå– â†’ åˆ†æ®µæ±‡æ€» â†’ æ•´ä½“åˆ†æ
- æå–ä¸–ç•Œè§‚ã€è§’è‰²ã€æƒ…èŠ‚ã€é£æ ¼å››å¤§è¦ç´ 
- ç”Ÿæˆæ ‡å‡†åŒ–JSONæ ¼å¼çš„æ¨¡æ¿æ–‡ä»¶
- è¾“å‡ºäººç±»å¯è¯»çš„åˆ†ææŠ¥å‘Š

### 1.3 åˆ†å±‚å¤„ç†ç­–ç•¥

**ä¸‰å±‚å¤„ç†æ¶æ„ï¼š**
```
ç¬¬ä¸€å±‚ï¼šå•ç« åˆ†æï¼ˆé€ç« æå–è¦ç´ ï¼‰
  â†“
ç¬¬äºŒå±‚ï¼šåˆ†æ®µæ±‡æ€»ï¼ˆæ¯20ç« æ€»ç»“ä¸€æ¬¡ï¼‰
  â†“  
ç¬¬ä¸‰å±‚ï¼šæ•´ä½“åˆ†æï¼ˆåŸºäºæ±‡æ€»ç»“æœåˆ†æå…¨æ–‡ï¼‰
```

### 1.4 è¾“å…¥è¾“å‡º

**è¾“å…¥ï¼š**
```
input_novels/
â””â”€â”€ æ–—ç ´è‹ç©¹/
    â”œâ”€â”€ ç¬¬001ç« .txt
    â”œâ”€â”€ ç¬¬002ç« .txt
    â”œâ”€â”€ ç¬¬003ç« .txt
    â””â”€â”€ ...ï¼ˆå…±300ç« ï¼‰
```

**ä¸­é—´äº§ç‰©ï¼š**
```
æ–—ç ´è‹ç©¹_intermediate/
â”œâ”€â”€ chapter_summaries/
â”‚   â”œâ”€â”€ chapter_001.json    # ç¬¬1ç« æå–ç»“æœ
â”‚   â”œâ”€â”€ chapter_002.json
â”‚   â””â”€â”€ ...
â”œâ”€â”€ segment_summaries/
â”‚   â”œâ”€â”€ segment_001-020.json  # ç¬¬1-20ç« æ±‡æ€»
â”‚   â”œâ”€â”€ segment_021-040.json  # ç¬¬21-40ç« æ±‡æ€»
â”‚   â””â”€â”€ ...
â””â”€â”€ extraction_log.json     # å¤„ç†æ—¥å¿—
```

**æœ€ç»ˆè¾“å‡ºï¼š**
```
templates/æ–—ç ´è‹ç©¹_template/
â”œâ”€â”€ world_bible.json          # ä¸–ç•Œè§‚è®¾å®š
â”œâ”€â”€ plot_framework.json       # æƒ…èŠ‚æ¡†æ¶
â”œâ”€â”€ writing_guide.json        # å†™ä½œæŒ‡å¯¼
â”œâ”€â”€ character_templates.json  # è§’è‰²æ¨¡æ¿
â”œâ”€â”€ quality_criteria.json     # è´¨é‡æ ‡å‡†
â””â”€â”€ analysis_report.md        # äººç±»å¯è¯»çš„åˆ†ææŠ¥å‘Š
```

## 2. æŠ€æœ¯æ¶æ„

### 2.1 æŠ€æœ¯æ ˆ
- **Python 3.10+**
- **LangChain 1.0** - LLMè°ƒç”¨æ¡†æ¶
- **OpenAI API** (GPT-4) æˆ– **Ollama** (æœ¬åœ°æ¨¡å‹)
- **æ ‡å‡†åº“ï¼š** os, json, re, pathlib

### 2.2 é¡¹ç›®ç»“æ„
```
novel_analyzer/
â”œâ”€â”€ analyzers/
â”‚   â”œâ”€â”€ __init__.py
â”‚   â”œâ”€â”€ preprocessor.py          # æ–‡ä»¶é¢„å¤„ç†æ¨¡å—
â”‚   â”œâ”€â”€ chapter_analyzer.py      # å•ç« åˆ†æå™¨
â”‚   â”œâ”€â”€ segment_summarizer.py    # åˆ†æ®µæ±‡æ€»å™¨
â”‚   â”œâ”€â”€ overall_analyzer.py      # æ•´ä½“åˆ†æå™¨
â”‚   â””â”€â”€ extractors/
â”‚       â”œâ”€â”€ world_extractor.py
â”‚       â”œâ”€â”€ character_extractor.py
â”‚       â”œâ”€â”€ plot_extractor.py
â”‚       â””â”€â”€ style_extractor.py
â”œâ”€â”€ generators/
â”‚   â”œâ”€â”€ __init__.py
â”‚   â””â”€â”€ template_generator.py    # æ¨¡æ¿ç”Ÿæˆå™¨
â”œâ”€â”€ utils/
â”‚   â”œâ”€â”€ __init__.py
â”‚   â”œâ”€â”€ file_utils.py            # æ–‡ä»¶æ“ä½œå·¥å…·
â”‚   â”œâ”€â”€ json_parser.py           # JSONè§£æå·¥å…·
â”‚   â””â”€â”€ prompt_templates.py      # Promptæ¨¡æ¿åº“
â”œâ”€â”€ config/
â”‚   â””â”€â”€ config.yaml              # é…ç½®æ–‡ä»¶
â”œâ”€â”€ data/
â”‚   â”œâ”€â”€ input_novels/            # è¾“å…¥å°è¯´ç›®å½•
â”‚   â”œâ”€â”€ intermediate/            # ä¸­é—´ç»“æœç›®å½•
â”‚   â””â”€â”€ output_templates/        # è¾“å‡ºæ¨¡æ¿ç›®å½•
â”œâ”€â”€ main.py                      # ä¸»ç¨‹åºå…¥å£
â”œâ”€â”€ requirements.txt             # ä¾èµ–åˆ—è¡¨
â””â”€â”€ README.md                    # ä½¿ç”¨è¯´æ˜
```

## 3. æ ¸å¿ƒå¤„ç†æµç¨‹

### 3.1 åˆ†å±‚å¤„ç†è¯¦ç»†æµç¨‹

```mermaid
graph TD
    A[åŠ è½½æ‰€æœ‰ç« èŠ‚æ–‡ä»¶] --> B[ç¬¬ä¸€å±‚ï¼šé€ç« åˆ†æ]
    B --> C[æå–å•ç« è¦ç´ JSON]
    C --> D{æ˜¯å¦è¾¾åˆ°20ç« }
    D -->|æ˜¯| E[ç¬¬äºŒå±‚ï¼šåˆ†æ®µæ±‡æ€»]
    D -->|å¦| B
    E --> F[ç”Ÿæˆåˆ†æ®µæ±‡æ€»JSON]
    F --> G{æ˜¯å¦å®Œæˆå…¨éƒ¨ç« èŠ‚}
    G -->|å¦| B
    G -->|æ˜¯| H[ç¬¬ä¸‰å±‚ï¼šæ•´ä½“åˆ†æ]
    H --> I[åŸºäºæ‰€æœ‰æ±‡æ€»è¿›è¡Œåˆ†æ]
    I --> J[ç”Ÿæˆæœ€ç»ˆæ¨¡æ¿]
```

### 3.2 ç¬¬ä¸€å±‚ï¼šå•ç« åˆ†æ

**ç›®æ ‡ï¼š** ä»æ¯ä¸€ç« ä¸­æå–å…³é”®ä¿¡æ¯

**è¾“å‡ºæ ¼å¼ (chapter_XXX.json)ï¼š**
```json
{
  "chapter_number": 1,
  "chapter_title": "é™¨è½çš„å¤©æ‰",
  "word_count": 3245,
  "characters": [
    {
      "name": "è§ç‚",
      "role": "protagonist",
      "first_appearance": true,
      "status_changes": ["æ–—æ°”ç­‰çº§ä¸‹é™"],
      "relationships": ["è§è–°å„¿çš„å…³æ³¨"]
    }
  ],
  "locations": [
    {
      "name": "è§å®¶",
      "type": "å®¶æ—é©»åœ°",
      "first_appearance": true
    }
  ],
  "events": [
    {
      "type": "conflict",
      "description": "è§ç‚è¢«å®¶æ—å¼Ÿå­å˜²ç¬‘",
      "importance": "high",
      "emotional_tone": "å±ˆè¾±ã€ä¸ç”˜"
    }
  ],
  "world_elements": [
    {
      "type": "power_system",
      "element": "æ–—æ°”ç­‰çº§",
      "details": "ä»å¤©æ‰è·Œè½åˆ°åºŸç‰©"
    }
  ],
  "writing_style_notes": {
    "narrative_perspective": "ç¬¬ä¸‰äººç§°",
    "key_phrases": ["ä¸‰å¹´ä¹‹çº¦"],
    "emotional_intensity": "high"
  }
}
```

### 3.3 ç¬¬äºŒå±‚ï¼šåˆ†æ®µæ±‡æ€»

**ç›®æ ‡ï¼š** æ¯20ç« æ±‡æ€»ä¸€æ¬¡ï¼Œæç‚¼å…³é”®ä¿¡æ¯

**è¾“å…¥ï¼š** 20ä¸ªç« èŠ‚çš„JSONæ–‡ä»¶
**è¾“å‡ºæ ¼å¼ (segment_001-020.json)ï¼š**
```json
{
  "segment_range": "001-020",
  "total_chapters": 20,
  "total_words": 65000,
  "characters_summary": {
    "main_characters": [
      {
        "name": "è§ç‚",
        "role": "protagonist",
        "development": "ä»åºŸæåˆ°å‘ç°æˆ’æŒ‡ç§˜å¯†",
        "key_relationships": ["è§è–°å„¿", "è¯è€"],
        "power_growth": "æ–—ä¹‹æ°”ä¸€æ®µ â†’ ä¸‰æ®µ"
      }
    ],
    "new_characters": ["è¯è€", "è§è–°å„¿", "è§å®"],
    "character_count": 8
  },
  "locations_summary": {
    "main_locations": ["è§å®¶", "ä¹Œå¦åŸ", "é­”å…½å±±è„‰"],
    "location_count": 5
  },
  "plot_summary": {
    "main_storyline": "è§ç‚å‘ç°æˆ’æŒ‡ä¸­çš„è¯è€ï¼Œå¼€å§‹æ¢å¤æ–—æ°”",
    "key_events": [
      "å‘ç°æˆ’æŒ‡ç§˜å¯†",
      "é‡è§è¯è€",
      "ç¬¬ä¸€æ¬¡ç‚¼è¯",
      "ä¸è§è–°å„¿çš„çº¦å®š"
    ],
    "conflicts": ["å®¶æ—å†…éƒ¨çŸ›ç›¾", "è§ç‚çš„è‡ªæˆ‘è¯æ˜"],
    "emotional_arc": "å±ˆè¾± â†’ å¸Œæœ› â†’ å†³å¿ƒ"
  },
  "world_building": {
    "power_system_details": ["æ–—ä¹‹æ°”ç­‰çº§ä½“ç³»", "ç‚¼è¯å¸ˆä½“ç³»"],
    "social_structure": ["å®¶æ—åˆ¶åº¦", "ç‚¼è¯å¸ˆåœ°ä½"],
    "special_items": ["çº³æˆ’", "å¼‚ç«"]
  },
  "style_patterns": {
    "chapter_structure": "äº‹ä»¶-å†²çª-å°é«˜æ½®-é’©å­",
    "pacing": "å¿«èŠ‚å¥",
    "dialogue_ratio": "ä¸­ç­‰"
  }
}
```

### 3.4 ç¬¬ä¸‰å±‚ï¼šæ•´ä½“åˆ†æ

**ç›®æ ‡ï¼š** åŸºäºæ‰€æœ‰åˆ†æ®µæ±‡æ€»ï¼Œè¿›è¡Œå…¨å±€åˆ†æ

**è¾“å…¥ï¼š** æ‰€æœ‰segmentæ±‡æ€»JSON
**è¾“å‡ºï¼š** æœ€ç»ˆçš„5ä¸ªæ¨¡æ¿æ–‡ä»¶

## 4. æ ¸å¿ƒæ¨¡å—è®¾è®¡

### 4.1 æ–‡ä»¶é¢„å¤„ç†æ¨¡å— (preprocessor.py)

**èŒè´£ï¼š** åŠ è½½ã€æ¸…æ´—ã€ç»„ç»‡å°è¯´æ–‡æœ¬

**æ ¸å¿ƒæ–¹æ³•ï¼š**
- `load_novel_files()` - åŠ è½½æ‰€æœ‰txtæ–‡ä»¶
- `clean_text()` - æ–‡æœ¬æ¸…æ´—
- `get_chapter_info()` - è·å–ç« èŠ‚åŸºæœ¬ä¿¡æ¯
- `get_statistics()` - ç»Ÿè®¡ä¿¡æ¯

### 4.2 å•ç« åˆ†æå™¨ (chapter_analyzer.py)

**èŒè´£ï¼š** åˆ†æå•ä¸ªç« èŠ‚ï¼Œæå–å…³é”®è¦ç´ 

**æ ¸å¿ƒæ–¹æ³•ï¼š**
- `analyze_chapter()` - åˆ†æå•ç« å†…å®¹
- `extract_characters()` - æå–è§’è‰²ä¿¡æ¯
- `extract_locations()` - æå–åœ°ç‚¹ä¿¡æ¯
- `extract_events()` - æå–äº‹ä»¶ä¿¡æ¯
- `extract_world_elements()` - æå–ä¸–ç•Œè§‚è¦ç´ 
- `save_chapter_result()` - ä¿å­˜å•ç« ç»“æœ

**è¾“å‡ºæ•°æ®ç»“æ„ï¼š**
```json
{
  "chapter_number": "æ•´æ•°",
  "chapter_title": "æ ‡é¢˜",
  "word_count": "å­—æ•°",
  "characters": [],
  "locations": [],
  "events": [],
  "world_elements": [],
  "writing_style_notes": {}
}
```

### 4.3 åˆ†æ®µæ±‡æ€»å™¨ (segment_summarizer.py)

**èŒè´£ï¼š** æ±‡æ€»Nä¸ªç« èŠ‚çš„åˆ†æç»“æœ

**æ ¸å¿ƒæ–¹æ³•ï¼š**
- `summarize_segment()` - æ±‡æ€»æŒ‡å®šèŒƒå›´ç« èŠ‚
- `merge_characters()` - åˆå¹¶è§’è‰²ä¿¡æ¯
- `merge_locations()` - åˆå¹¶åœ°ç‚¹ä¿¡æ¯
- `summarize_plot()` - æ€»ç»“æƒ…èŠ‚å‘å±•
- `extract_patterns()` - æå–å†™ä½œæ¨¡å¼
- `save_segment_summary()` - ä¿å­˜åˆ†æ®µæ±‡æ€»

**è¾“å‡ºæ•°æ®ç»“æ„ï¼š**
```json
{
  "segment_range": "èµ·å§‹-ç»“æŸ",
  "total_chapters": "ç« èŠ‚æ•°",
  "characters_summary": {},
  "locations_summary": {},
  "plot_summary": {},
  "world_building": {},
  "style_patterns": {}
}
```

### 4.4 æ•´ä½“åˆ†æå™¨ (overall_analyzer.py)

**èŒè´£ï¼š** åŸºäºæ‰€æœ‰åˆ†æ®µæ±‡æ€»è¿›è¡Œå…¨å±€åˆ†æ

**æ ¸å¿ƒæ–¹æ³•ï¼š**
- `analyze_all_segments()` - åˆ†ææ‰€æœ‰åˆ†æ®µæ±‡æ€»
- `extract_world_bible()` - æå–å®Œæ•´ä¸–ç•Œè§‚
- `extract_character_templates()` - æå–è§’è‰²æ¨¡æ¿
- `extract_plot_framework()` - æå–æƒ…èŠ‚æ¡†æ¶
- `extract_writing_guide()` - æå–å†™ä½œæŒ‡å¯¼
- `extract_quality_criteria()` - æå–è´¨é‡æ ‡å‡†

### 4.5 å„è¦ç´ æå–å™¨

#### 4.5.1 ä¸–ç•Œè§‚æå–å™¨ (world_extractor.py)

**æå–å†…å®¹ï¼š**
```json
{
  "basic_setting": {
    "time_period": "æ—¶ä»£èƒŒæ™¯",
    "world_type": "ä¸–ç•Œç±»å‹",
    "core_concept": "æ ¸å¿ƒæ¦‚å¿µ",
    "basic_rules": []
  },
  "power_system": {
    "system_name": "åŠ›é‡ä½“ç³»åç§°",
    "levels": [],
    "advancement_method": "æå‡æ–¹å¼",
    "special_abilities": []
  },
  "locations": [],
  "social_rules": {},
  "special_items": []
}
```

#### 4.5.2 è§’è‰²æå–å™¨ (character_extractor.py)

**æå–å†…å®¹ï¼š**
```json
{
  "protagonist": {
    "name": "ä¸»è§’åå­—",
    "archetype": "è§’è‰²åŸå‹",
    "initial_state": {},
    "growth_arc": {},
    "relationships": {}
  },
  "antagonist": {},
  "supporting_cast": []
}
```

#### 4.5.3 æƒ…èŠ‚æå–å™¨ (plot_extractor.py)

**æå–å†…å®¹ï¼š**
```json
{
  "story_structure": {
    "act1": {},
    "act2": {},
    "act3": {}
  },
  "conflict_progression": {},
  "key_plot_points": [],
  "pacing_guide": {},
  "chapter_templates": {}
}
```

#### 4.5.4 é£æ ¼æå–å™¨ (style_extractor.py)

**æå–å†…å®¹ï¼š**
```json
{
  "narrative_voice": {},
  "dialogue_style": {},
  "description_templates": {},
  "scene_transition": {},
  "emotional_beats": {},
  "language_features": {}
}
```

### 4.6 æ¨¡æ¿ç”Ÿæˆå™¨ (template_generator.py)

**èŒè´£ï¼š** æ•´åˆæ‰€æœ‰æå–ç»“æœï¼Œç”Ÿæˆæœ€ç»ˆæ ‡å‡†åŒ–æ¨¡æ¿

**æ ¸å¿ƒæ–¹æ³•ï¼š**
- `generate_world_bible()` - ç”Ÿæˆä¸–ç•Œè§‚æ¨¡æ¿
- `generate_plot_framework()` - ç”Ÿæˆæƒ…èŠ‚æ¡†æ¶
- `generate_writing_guide()` - ç”Ÿæˆå†™ä½œæŒ‡å¯¼
- `generate_character_templates()` - ç”Ÿæˆè§’è‰²æ¨¡æ¿
- `generate_quality_criteria()` - ç”Ÿæˆè´¨é‡æ ‡å‡†
- `save_all_templates()` - ä¿å­˜æ‰€æœ‰æ¨¡æ¿
- `generate_markdown_report()` - ç”Ÿæˆåˆ†ææŠ¥å‘Š

## 5. Promptè®¾è®¡æ¨¡æ¿

### 5.1 å•ç« åˆ†æPrompt

**ç« èŠ‚è¦ç´ æå–ï¼š**
```
åˆ†æä»¥ä¸‹å°è¯´ç« èŠ‚ï¼Œæå–å…³é”®ä¿¡æ¯ã€‚

ç« èŠ‚å†…å®¹ï¼š
{chapter_text}

è¯·ä¸¥æ ¼æŒ‰ç…§ä»¥ä¸‹JSONæ ¼å¼è¾“å‡ºï¼š
{
  "chapter_number": ç« èŠ‚åºå·,
  "characters": [
    {
      "name": "è§’è‰²å",
      "role": "protagonist/antagonist/supporting",
      "first_appearance": true/false,
      "status_changes": ["å˜åŒ–æè¿°"],
      "relationships": ["å…³ç³»æè¿°"]
    }
  ],
  "locations": [
    {
      "name": "åœ°ç‚¹å",
      "type": "åœ°ç‚¹ç±»å‹",
      "first_appearance": true/false
    }
  ],
  "events": [
    {
      "type": "conflict/development/climax",
      "description": "äº‹ä»¶æè¿°",
      "importance": "high/medium/low",
      "emotional_tone": "æƒ…æ„ŸåŸºè°ƒ"
    }
  ],
  "world_elements": [
    {
      "type": "power_system/social_rule/special_item",
      "element": "è¦ç´ åç§°",
      "details": "è¯¦ç»†ä¿¡æ¯"
    }
  ],
  "writing_style_notes": {
    "narrative_perspective": "å™äº‹è§†è§’",
    "key_phrases": ["å…³é”®çŸ­è¯­"],
    "emotional_intensity": "high/medium/low"
  }
}

åªè¾“å‡ºJSONï¼Œä¸è¦å…¶ä»–æ–‡å­—ã€‚
```

### 5.2 åˆ†æ®µæ±‡æ€»Prompt

**åˆ†æ®µæ¦‚æ‹¬ï¼š**
```
åŸºäºä»¥ä¸‹20ä¸ªç« èŠ‚çš„åˆ†æç»“æœï¼Œè¿›è¡Œæ±‡æ€»æ¦‚æ‹¬ã€‚

ç« èŠ‚åˆ†ææ•°æ®ï¼š
{ç« èŠ‚JSONåˆ—è¡¨}

è¯·ä¸¥æ ¼æŒ‰ç…§ä»¥ä¸‹JSONæ ¼å¼è¾“å‡ºï¼š
{
  "segment_range": "èµ·å§‹-ç»“æŸ",
  "characters_summary": {
    "main_characters": [
      {
        "name": "è§’è‰²å",
        "role": "è§’è‰²å®šä½",
        "development": "å‘å±•å˜åŒ–",
        "key_relationships": [],
        "power_growth": "å®åŠ›æˆé•¿"
      }
    ],
    "new_characters": [],
    "character_count": æ•°å­—
  },
  "locations_summary": {
    "main_locations": [],
    "location_count": æ•°å­—
  },
  "plot_summary": {
    "main_storyline": "ä¸»çº¿å‰§æƒ…æ¦‚è¿°",
    "key_events": [],
    "conflicts": [],
    "emotional_arc": "æƒ…æ„Ÿæ›²çº¿"
  },
  "world_building": {
    "power_system_details": [],
    "social_structure": [],
    "special_items": []
  },
  "style_patterns": {
    "chapter_structure": "ç« èŠ‚ç»“æ„æ¨¡å¼",
    "pacing": "èŠ‚å¥",
    "dialogue_ratio": "å¯¹è¯æ¯”ä¾‹"
  }
}

åªè¾“å‡ºJSONï¼Œä¸è¦å…¶ä»–æ–‡å­—ã€‚
```

### 5.3 æ•´ä½“åˆ†æPrompt

**ä¸–ç•Œè§‚æ•´åˆï¼š**
```
åŸºäºä»¥ä¸‹æ‰€æœ‰åˆ†æ®µæ±‡æ€»ï¼Œæå–å®Œæ•´çš„ä¸–ç•Œè§‚è®¾å®šã€‚

åˆ†æ®µæ±‡æ€»æ•°æ®ï¼š
{æ‰€æœ‰segment JSON}

è¯·ä¸¥æ ¼æŒ‰ç…§ä»¥ä¸‹JSONæ ¼å¼è¾“å‡ºå®Œæ•´ä¸–ç•Œè§‚ï¼š
{
  "basic_setting": {...},
  "power_system": {...},
  "locations": [...],
  "social_rules": {...},
  "special_items": [...]
}

åªè¾“å‡ºJSONï¼Œä¸è¦å…¶ä»–æ–‡å­—ã€‚
```

**è§’è‰²æ¨¡æ¿æ•´åˆã€æƒ…èŠ‚æ¡†æ¶æ•´åˆã€é£æ ¼æŒ‡å¯¼æ•´åˆç­‰ç±»ä¼¼è®¾è®¡**

## 6. å¼€å‘æµç¨‹

### 6.1 Phase 1: åŸºç¡€æ¡†æ¶æ­å»ºï¼ˆ2-3å¤©ï¼‰

**ä»»åŠ¡æ¸…å•ï¼š**
- [ ] åˆ›å»ºé¡¹ç›®ç›®å½•ç»“æ„
- [ ] é…ç½®å¼€å‘ç¯å¢ƒå’Œä¾èµ–
- [ ] å®ç°æ–‡ä»¶é¢„å¤„ç†æ¨¡å—
- [ ] å®ç°æ–‡ä»¶å·¥å…·å’ŒJSONè§£æå·¥å…·
- [ ] æµ‹è¯•æ•°æ®å‡†å¤‡ï¼ˆ1æœ¬å°è¯´æ ·æœ¬ï¼Œçº¦50ç« ï¼‰

**éªŒæ”¶æ ‡å‡†ï¼š**
- èƒ½å¤ŸæˆåŠŸåŠ è½½æ‰€æœ‰ç« èŠ‚æ–‡ä»¶
- æ–‡æœ¬æ¸…æ´—æ­£å¸¸
- èƒ½æ­£ç¡®è¯†åˆ«ç« èŠ‚é¡ºåºå’Œç»Ÿè®¡ä¿¡æ¯

### 6.2 Phase 2: å•ç« åˆ†æå™¨å¼€å‘ï¼ˆ3-4å¤©ï¼‰

**ä»»åŠ¡æ¸…å•ï¼š**
- [ ] å®ç°ChapterAnalyzerç±»
- [ ] è®¾è®¡å•ç« åˆ†æPrompt
- [ ] å®ç°ç« èŠ‚è¦ç´ æå–é€»è¾‘
- [ ] å®ç°JSONç»“æœä¿å­˜
- [ ] æµ‹è¯•å•ç« åˆ†æåŠŸèƒ½
- [ ] ä¼˜åŒ–Promptå‡†ç¡®æ€§

**éªŒæ”¶æ ‡å‡†ï¼š**
- èƒ½æˆåŠŸåˆ†æå•ä¸ªç« èŠ‚
- è¾“å‡ºJSONæ ¼å¼æ­£ç¡®
- æå–çš„ä¿¡æ¯å‡†ç¡®å®Œæ•´
- å¯ä»¥æ‰¹é‡å¤„ç†å¤šç« 

### 6.3 Phase 3: åˆ†æ®µæ±‡æ€»å™¨å¼€å‘ï¼ˆ2-3å¤©ï¼‰

**ä»»åŠ¡æ¸…å•ï¼š**
- [ ] å®ç°SegmentSummarizerç±»
- [ ] è®¾è®¡åˆ†æ®µæ±‡æ€»Prompt
- [ ] å®ç°è§’è‰²/åœ°ç‚¹/äº‹ä»¶åˆå¹¶é€»è¾‘
- [ ] å®ç°æƒ…èŠ‚æ¦‚æ‹¬é€»è¾‘
- [ ] æµ‹è¯•åˆ†æ®µæ±‡æ€»åŠŸèƒ½

**éªŒæ”¶æ ‡å‡†ï¼š**
- èƒ½æ­£ç¡®æ±‡æ€»20ç« å†…å®¹
- ä¿¡æ¯å»é‡å’Œæ•´åˆæ­£ç¡®
- æ¦‚æ‹¬å‡†ç¡®ä¸”ä¸é—æ¼å…³é”®ä¿¡æ¯

### 6.4 Phase 4: æ•´ä½“åˆ†æå™¨å’Œæå–å™¨å¼€å‘ï¼ˆ4-5å¤©ï¼‰

**ä»»åŠ¡æ¸…å•ï¼š**
- [ ] å®ç°OverallAnalyzerç±»
- [ ] å®ç°WorldExtractor
- [ ] å®ç°CharacterExtractor
- [ ] å®ç°PlotExtractor
- [ ] å®ç°StyleExtractor
- [ ] è®¾è®¡æ•´åˆPrompt
- [ ] æµ‹è¯•å„æå–å™¨åŠŸèƒ½

**éªŒæ”¶æ ‡å‡†ï¼š**
- èƒ½åŸºäºæ‰€æœ‰åˆ†æ®µæ±‡æ€»è¿›è¡Œåˆ†æ
- å„æå–å™¨è¾“å‡ºæ ¼å¼æ­£ç¡®
- æå–çš„æ¨¡æ¿è´¨é‡é«˜

### 6.5 Phase 5: æ¨¡æ¿ç”Ÿæˆå™¨å¼€å‘ï¼ˆ2-3å¤©ï¼‰

**ä»»åŠ¡æ¸…å•ï¼š**
- [ ] å®ç°TemplateGeneratorç±»
- [ ] å®ç°5ä¸ªæ¨¡æ¿ç”Ÿæˆæ–¹æ³•
- [ ] å®ç°æ–‡ä»¶ä¿å­˜åŠŸèƒ½
- [ ] å®ç°markdownæŠ¥å‘Šç”Ÿæˆ
- [ ] æµ‹è¯•å®Œæ•´æµç¨‹

**éªŒæ”¶æ ‡å‡†ï¼š**
- èƒ½ç”Ÿæˆ5ä¸ªæ ‡å‡†JSONæ–‡ä»¶
- JSONæ ¼å¼è§„èŒƒä¸”å®Œæ•´
- markdownæŠ¥å‘Šç¾è§‚æ˜“è¯»

### 6.6 Phase 6: ä¸»ç¨‹åºé›†æˆï¼ˆ1-2å¤©ï¼‰

**ä»»åŠ¡æ¸…å•ï¼š**
- [ ] å®ç°main.pyä¸»æµç¨‹
- [ ] æ·»åŠ å‘½ä»¤è¡Œå‚æ•°
- [ ] æ·»åŠ è¿›åº¦æ¡æ˜¾ç¤º
- [ ] æ·»åŠ é”™è¯¯å¤„ç†å’Œé‡è¯•æœºåˆ¶
- [ ] æ·»åŠ æ—¥å¿—è®°å½•
- [ ] ç¼–å†™READMEæ–‡æ¡£

**éªŒæ”¶æ ‡å‡†ï¼š**
- å®Œæ•´æµç¨‹è¿è¡Œæµç•…
- è¿›åº¦æ˜¾ç¤ºæ¸…æ™°
- é”™è¯¯å¤„ç†å®Œå–„
- æ–‡æ¡£å®Œæ•´

### 6.7 Phase 7: æµ‹è¯•ä¸ä¼˜åŒ–ï¼ˆ2-3å¤©ï¼‰

**ä»»åŠ¡æ¸…å•ï¼š**
- [ ] ä½¿ç”¨å®Œæ•´å°è¯´è¿›è¡Œç«¯åˆ°ç«¯æµ‹è¯•
- [ ] æµ‹è¯•ä¸åŒç±»å‹å°è¯´ï¼ˆä»™ä¾ ã€éƒ½å¸‚ã€ç§‘å¹»ï¼‰
- [ ] æ”¶é›†å’Œä¿®å¤bug
- [ ] ä¼˜åŒ–Promptæé«˜å‡†ç¡®æ€§
- [ ] ä¼˜åŒ–æ€§èƒ½å’Œå†…å­˜ä½¿ç”¨
- [ ] ä»£ç é‡æ„å’Œæ¸…ç†

**éªŒæ”¶æ ‡å‡†ï¼š**
- èƒ½æˆåŠŸåˆ†æè‡³å°‘2æœ¬å®Œæ•´å°è¯´ï¼ˆ200+ç« ï¼‰
- æå–çš„æ¨¡æ¿è´¨é‡é«˜
- è¿è¡Œç¨³å®šæ— å´©æºƒ
- å¤„ç†é€Ÿåº¦åˆç†

## 7. é…ç½®æ–‡ä»¶è®¾è®¡

### 7.1 config.yaml
```yaml
# LLMé…ç½®
llm:
  provider: "openai"
  model: "gpt-4"
  api_key: "your-api-key-here"
  base_url: null
  temperature: 0.3
  max_tokens: 3000

# åˆ†å±‚å¤„ç†é…ç½®
processing:
  chapter_batch_size: 1          # å•æ¬¡å¤„ç†ç« èŠ‚æ•°
  segment_size: 20               # æ¯ä¸ªåˆ†æ®µåŒ…å«çš„ç« èŠ‚æ•°
  save_intermediate: true        # æ˜¯å¦ä¿å­˜ä¸­é—´ç»“æœ
  
# æ–‡æœ¬å¤„ç†é…ç½®
preprocessing:
  encoding: "utf-8"
  min_chapter_length: 500        # æœ€å°ç« èŠ‚å­—æ•°
  max_chapter_length: 20000      # æœ€å¤§ç« èŠ‚å­—æ•°
  
# æå–é…ç½®
extraction:
  retry_times: 3                 # JSONè§£æå¤±è´¥é‡è¯•æ¬¡æ•°
  timeout: 60                    # å•æ¬¡LLMè°ƒç”¨è¶…æ—¶(ç§’)
  
# è¾“å‡ºé…ç½®
output:
  generate_report: true
  pretty_json: true
  
# æ—¥å¿—é…ç½®
logging:
  level: "INFO"
  file: "logs/analyzer.log"
```

## 8. ä¾èµ–åˆ—è¡¨

### 8.1 requirements.txt
```
langchain>=0.1.0
langchain-openai>=0.0.5
python-dotenv>=1.0.0
pyyaml>=6.0
pydantic>=2.0.0
tqdm>=4.65.0
```

## 9. ä½¿ç”¨ç¤ºä¾‹

### 9.1 åŸºæœ¬ä½¿ç”¨
```bash
# å®‰è£…ä¾èµ–
pip install -r requirements.txt

# é…ç½®API Key
export OPENAI_API_KEY="your-api-key"

# è¿è¡Œå®Œæ•´åˆ†æ
python main.py --input ./data/input_novels/æ–—ç ´è‹ç©¹/ --output ./data/output_templates/æ–—ç ´è‹ç©¹_template/
```

### 9.2 è¿è¡Œè¿‡ç¨‹ç¤ºä¾‹
```
å¼€å§‹åˆ†æå°è¯´...
ğŸ“ åŠ è½½æ–‡ä»¶: 300ä¸ªç« èŠ‚æ–‡ä»¶
ğŸ“Š ç»Ÿè®¡ä¿¡æ¯: æ€»å­—æ•°=1,200,000, ç« èŠ‚æ•°=300

â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
ç¬¬ä¸€å±‚ï¼šå•ç« åˆ†æ
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
ğŸ“– åˆ†æç« èŠ‚: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 300/300 [45:00<00:00, 9.0s/ç« ]
ğŸ’¾ å·²ä¿å­˜å•ç« ç»“æœ: 300ä¸ªJSONæ–‡ä»¶

â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
ç¬¬äºŒå±‚ï¼šåˆ†æ®µæ±‡æ€»ï¼ˆæ¯20ç« ï¼‰
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
ğŸ“ æ±‡æ€»åˆ†æ®µ 001-020: âœ“
ğŸ“ æ±‡æ€»åˆ†æ®µ 021-040: âœ“
...
ğŸ“ æ±‡æ€»åˆ†æ®µ 281-300: âœ“
ğŸ’¾ å·²ä¿å­˜åˆ†æ®µæ±‡æ€»: 15ä¸ªJSONæ–‡ä»¶

â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
ç¬¬ä¸‰å±‚ï¼šæ•´ä½“åˆ†æ
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
ğŸŒ æå–ä¸–ç•Œè§‚è®¾å®š: âœ“
ğŸ‘¥ æå–è§’è‰²æ¨¡æ¿: âœ“
ğŸ“– æå–æƒ…èŠ‚æ¡†æ¶: âœ“
âœï¸ æå–å†™ä½œé£æ ¼: âœ“
â­ ç”Ÿæˆè´¨é‡æ ‡å‡†: âœ“

â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
ç”Ÿæˆæœ€ç»ˆæ¨¡æ¿
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
ğŸ’¾ ç”Ÿæˆæ¨¡æ¿æ–‡ä»¶:
  âœ“ world_bible.json
  âœ“ plot_framework.json
  âœ“ writing_guide.json
  âœ“ character_templates.json
  âœ“ quality_criteria.json
  âœ“ analysis_report.md

âœ… åˆ†æå®Œæˆï¼
   ç”¨æ—¶: 1å°æ—¶15åˆ†é’Ÿ
   ç»“æœ: ./data/output_templates/æ–—ç ´è‹ç©¹_template/
```

## 10. é£é™©ä¸æŒ‘æˆ˜

### 10.1 æŠ€æœ¯é£é™©
| é£é™© | å½±å“ | åº”å¯¹æ–¹æ¡ˆ |
|------|------|---------|
| LLMè¿”å›æ ¼å¼ä¸ç¨³å®š | JSONè§£æå¤±è´¥ | å¤šæ¬¡é‡è¯•+æ ¼å¼ä¿®å¤é€»è¾‘ |
| é•¿ç¯‡å°è¯´å¤„ç†è€—æ—¶é•¿ | ç”¨æˆ·ç­‰å¾…æ—¶é—´é•¿ | è¿›åº¦æ˜¾ç¤º+æ–­ç‚¹ç»­ä¼  |
| APIè´¹ç”¨è¾ƒé«˜ | æˆæœ¬é—®é¢˜ | æ”¯æŒOllamaæœ¬åœ°æ¨¡å‹ |
| ä¸­é—´æ–‡ä»¶å ç”¨ç©ºé—´å¤§ | å­˜å‚¨é—®é¢˜ | å¯é…ç½®æ¸…ç†ä¸­é—´æ–‡ä»¶ |

### 10.2 è´¨é‡é£é™©
| é£é™© | å½±å“ | åº”å¯¹æ–¹æ¡ˆ |
|------|------|---------|
| å•ç« åˆ†æä¿¡æ¯é—æ¼ | æ±‡æ€»ä¸å®Œæ•´ | ä¼˜åŒ–Prompt+å¤šæ¬¡éªŒè¯ |
| åˆ†æ®µæ±‡æ€»ä¸¢å¤±ç»†èŠ‚ | æ¨¡æ¿ä¸ç²¾ç¡® | ä¿ç•™å…³é”®ç»†èŠ‚æ ‡è®° |
| ä¸åŒç±»å‹å°è¯´å·®å¼‚å¤§ | é€šç”¨æ€§å·® | åˆ†ç±»å‹Promptæ¨¡æ¿ |

## 11. åç»­æ‰©å±•æ–¹å‘

### 11.1 åŠŸèƒ½å¢å¼º
- æ”¯æŒepubã€pdfç­‰æ ¼å¼
- æ”¯æŒåœ¨çº¿å°è¯´çˆ¬å–
- æ·»åŠ Webå¯è§†åŒ–ç•Œé¢
- æ”¯æŒæ‰¹é‡åˆ†æå¤šæœ¬å°è¯´
- æ”¯æŒå¢é‡æ›´æ–°ï¼ˆæ–°å¢ç« èŠ‚æ—¶ï¼‰

### 11.2 æ€§èƒ½ä¼˜åŒ–
- å¹¶å‘å¤„ç†å¤šä¸ªç« èŠ‚
- LLMè°ƒç”¨ç»“æœç¼“å­˜
- æ–­ç‚¹ç»­ä¼ æœºåˆ¶
- æ™ºèƒ½é‡‡æ ·ï¼ˆä¸åˆ†ææ‰€æœ‰ç« èŠ‚ï¼‰

### 11.3 è´¨é‡æå‡
- äººå·¥å®¡æ ¸ç•Œé¢
- æ¨¡æ¿è´¨é‡è‡ªåŠ¨è¯„åˆ†
- å¤šç‰ˆæœ¬æ¨¡æ¿å¯¹æ¯”
- å…³é”®ä¿¡æ¯äººå·¥æ ‡æ³¨

---

**é¢„è®¡æ€»å¼€å‘æ—¶é—´ï¼š** 16-23å¤©

**å…³é”®é‡Œç¨‹ç¢‘ï¼š**
- Day 3: å®ŒæˆåŸºç¡€æ¡†æ¶
- Day 7: å®Œæˆå•ç« åˆ†æå™¨
- Day 10: å®Œæˆåˆ†æ®µæ±‡æ€»å™¨
- Day 15: å®Œæˆæ‰€æœ‰æå–å™¨å’Œæ¨¡æ¿ç”Ÿæˆ
- Day 17: å®Œæˆä¸»ç¨‹åºé›†æˆ
- Day 23: å®Œæˆæµ‹è¯•å’Œä¼˜åŒ–

## 12. æ€»ç»“

æœ¬æ–¹æ¡ˆé‡‡ç”¨**åˆ†å±‚æ¦‚æ‹¬ç­–ç•¥**ï¼Œæœ‰æ•ˆè§£å†³äº†é•¿ç¯‡å°è¯´å†…å®¹è¿‡å¤šçš„é—®é¢˜ï¼š

âœ… **ç¬¬ä¸€å±‚**é€ç« æå–ï¼Œä¿è¯ç»†èŠ‚ä¸é—æ¼
âœ… **ç¬¬äºŒå±‚**åˆ†æ®µæ±‡æ€»ï¼Œå‹ç¼©ä¿¡æ¯é‡
âœ… **ç¬¬ä¸‰å±‚**æ•´ä½“åˆ†æï¼ŒæŠŠæ¡å…¨å±€ç‰¹å¾

è¿™ç§æ–¹å¼æ—¢èƒ½å¤„ç†ä¸Šç™¾ä¸‡å­—çš„é•¿ç¯‡å°è¯´ï¼Œåˆèƒ½ä¿è¯æå–è´¨é‡ï¼Œä¸ºåç»­çš„å°è¯´åˆ›ä½œæä¾›é«˜è´¨é‡çš„å‚è€ƒæ¨¡æ¿ã€‚